<div class="device-list-container">
  <div class="device-list-header">
    <button nz-button nzType="primary" (click)="openModal()">
      <span nz-icon nzType="plus"></span>
      Add New Device
    </button>
  </div>

  <nz-radio-group [(ngModel)]="selectedDeviceId" (ngModelChange)="onDeviceSelectionChange($event)">
    <nz-table
      #deviceTable
      [nzData]="entries()"
      [nzLoading]="isLoading()"
      nzSize="middle"
      [nzShowPagination]="false"
      [nzNoResult]="''">

      <thead>
      <tr>
        <th nzWidth="50px"></th>
        <th nzWidth="200px">Device Name</th>
        <!--<th nzWidth="150px">IP Address</th>-->
        <th nzWidth="70px">Actions</th>
      </tr>
      </thead>

      <tbody>
        @for (entry of entries(); track entry?.id) {
          <tr>
            <td>
              <label nz-radio [nzValue]="entry.id">
                <span></span>
              </label>
            </td>
            <td>{{ entry.device }}</td>
            <!--<td>{{ entry.ip }}</td>-->
            <td>
              <button
                nz-button
                nzType="link"
                nzSize="small"
                (click)="openEditModal(entry)">
                <span nz-icon nzType="edit"></span>
              </button>
              <button
                nz-button
                nzType="link"
                nzSize="small"
                nzDanger
                nz-popconfirm="Are you sure you want to delete this entry?"
                (nzOnConfirm)="deleteEntry(entry.id!)">
                <span nz-icon nzType="delete"></span>
              </button>
            </td>
          </tr>
        } @empty {
          <tr>
            <td colspan="3" class="empty-row">
              <div class="custom-empty-state">
                <span nz-icon nzType="inbox" class="empty-icon"></span>
                <h3>No devices yet</h3>
                <p>Create your first device to get started!</p>
                <button nz-button nzType="primary" (click)="openModal()">
                  <span nz-icon nzType="plus"></span>
                  Add New Device
                </button>
              </div>
            </td>
          </tr>
        }
      </tbody>
    </nz-table>
  </nz-radio-group>

  <!-- Report Viewer Section - Now embedded in device list -->
  <div class="report-viewer-section" style="margin-top: 24px;">
    <app-report-viewer></app-report-viewer>
  </div>

  <app-entry-modal
    [visible]="isModalVisible"
    [loading]="isLoading()"
    [editMode]="isEditMode"
    [entryData]="editingEntry"
    (save)="onModalSave($event)"
    (cancel)="onModalCancel()">
  </app-entry-modal>
</div>
